# AGENTS.md — DROID Desktop GUI Project

本ファイルは、本リポジトリにおいて使用されるAIエージェント（例：Factory.ai DROID、GitHub Copilot等）が、プロジェクトの目的・構成・運用方針・品質基準を正しく理解し、一貫性と監査性を保った支援を行うためのガイドラインです。

本プロジェクトは業務利用を前提としており、**再現性・説明可能性・人間による統制（Human-in-the-loop）**を最重要原則とします。

---

## 1. プロジェクト概要

本リポジトリは、Factory.ai の DROID CLI を簡易かつ安全に利用するための **WindowsデスクトップGUIツール群**を提供します。  
PowerShell と Windows Forms（.NET Framework）を基盤とし、業務環境における操作性とトレーサビリティの確保を目的としています。

主な設計思想：
- CLI操作のGUI化による業務負荷の軽減
- 実行内容および結果のログ保存による追跡可能性の確保
- 設定ファイルの明示的管理による再現性の担保

---

## 2. ファイル構成

```
Droid/
├── run-droid.bat              # GUI起動用バッチファイル（エントリーポイント）
├── gui_droid_winforms.ps1   # Windows Forms GUIアプリケーション（メイン）
├── gui_droid.py            # Python版GUI（レガシー／非推奨）
├── invoke-droid.ps1       # DROID CLI実行ラッパースクリプト
├── prompt.json            # プロンプト設定テンプレート
├── docs/                 # ドキュメント
├── Test/                # テストスイート
├── logs/                # 実行ログ出力先
└── Result/              # 実行結果出力先
```

---

## 3. 技術スタック

- **GUIフレームワーク**: PowerShell Windows Forms（.NET Framework）  
- **言語**: PowerShell 5.1+  
- **テストフレームワーク**: Python pytest  
- **外部依存**: Factory.ai DROID CLI

---

## 4. AIエージェントの行動方針

### 4.1 許可される行動（Allowed Actions）

AIエージェントは以下の支援を行うことができます：

- PowerShellスクリプトの改善提案
- ドキュメントの作成・更新
- テストコードおよびテストケースの提案
- 可読性・保守性向上のためのリファクタリング案の提示

※ 実際の変更適用は人間の承認を前提とします。

---

### 4.2 禁止事項（Prohibited Actions）

以下の行為は明示的に禁止されます：

- `main` / `release` / 本番運用ブランチへの直接的な変更
- DROID実行ロジックまたはログ出力処理の無断変更
- 外部API、外部システム、ネットワークリソースへのアクセス
- 設定ファイルや監査・証跡関連機構の削除または無効化

---

### 4.3 承認要件（Approval Requirements）

以下に影響する変更は、必ず人間のレビューおよび承認を必要とします：

- CLI実行フロー
- 設定ファイルの構造および解釈ロジック
- ログ出力形式および保存仕様
- テスト結果の評価ロジック

---

## 5. コーディング規約

### 5.1 PowerShell

- 変数名: `$camelCase`
- 関数名: `Verb-Noun` 形式
- スコープは明示的に指定すること
- 例外処理およびエラーハンドリングを必ず実装すること
- 副作用のある処理（ファイル書き込み・CLI実行）はコメントで明示すること

### 5.2 ドキュメント

- 言語: 日本語
- 形式: Markdown
- 操作手順および前提条件は明示的に記載すること

---

## 6. 重要ファイル

| ファイル | 役割 |
|----------|------|
| `gui_droid_winforms.ps1` | メインGUIアプリケーション |
| `invoke-droid.ps1` | DROID CLIラッパーおよび実行制御 |
| `prompt.json` | 設定ファイルテンプレート |

---

## 7. ビルドおよび実行方法

```cmd
# GUIを起動
run-droid.bat

# PowerShellから直接起動
powershell -NoProfile -ExecutionPolicy Bypass -File gui_droid_winforms.ps1
```

---

## 8. テスト実行

```cmd
cd Test
python run_all_tests.py
```

---

## 9. 品質および出力基準

AIエージェントおよび人間による成果物は、以下の基準を満たす必要があります：

- 処理ロジックは説明可能であること
- 前提条件および制約事項が明示されていること
- 実行結果がログとして追跡可能であること
- 再実行時に同一条件で同一結果が得られる設計であること

---

## 10. 注意事項

- Windows環境専用
- `droid` CLIが `PATH` に登録されている必要があります
- すべてのファイルは UTF-8 エンコーディングを使用してください

---

## 11. トレーサビリティ方針

AIエージェントが生成または提案した変更については、以下の情報を記録してください：

- 変更概要
- 生成または提案の目的
- 対応するタスクまたはプロンプト
- 実施日時

これにより、変更の根拠および影響範囲を後から検証可能な状態に保ちます。

