# WPF GUI テスト計画

## テスト環境

### 必須
- Windows 10 (バージョン 1809 以降) または Windows 11
- .NET 8.0 SDK
- Factory.ai DROID インストール済み

### 推奨
- Visual Studio 2022 (Community 以上) または JetBrains Rider
- Git for Windows

## ビルドテスト

### 1. 初回ビルド

```cmd
cd DroidWpfGui
dotnet restore
dotnet build
```

#### 期待される結果
- ✅ NuGet パッケージが正常に復元される
- ✅ ModernWpfUI (v0.9.6) がダウンロードされる
- ✅ コンパイルエラーなく完了する
- ✅ bin\Debug\net8.0-windows\DroidWpfGui.exe が生成される

### 2. リリースビルド

```cmd
dotnet build -c Release
```

#### 期待される結果
- ✅ 最適化されたビルドが完了する
- ✅ bin\Release\net8.0-windows\DroidWpfGui.exe が生成される

## UI表示テスト

### 3. アプリケーション起動

```cmd
dotnet run
```

または

```cmd
run-droid-wpf.bat
```

#### 期待される結果
- ✅ ウィンドウが中央に表示される
- ✅ ウィンドウサイズ: 850x810 ピクセル
- ✅ タイトル: "DROID Desktop GUI"
- ✅ ModernWpf のスタイルが適用されている

### 4. UI要素の確認

#### プロンプト入力エリア
- [ ] ラベル "プロンプト (Prompt) *" が表示されている
- [ ] 複数行テキストボックスが表示されている
- [ ] スクロールバーが機能する
- [ ] テキスト入力が可能

#### オプション設定グループ
- [ ] GroupBox "オプション設定" が表示されている
- [ ] 作業ディレクトリ: テキストボックス + 参照ボタン
- [ ] モデル: ComboBox に4つのモデルが表示
  - claude-opus-4-5-20251101
  - claude-sonnet-4-20250514 (デフォルト選択)
  - claude-sonnet-4-5-20241022
  - claude-haiku-4-20250116
- [ ] 自動化レベル: ComboBox に3つのレベルが表示
  - low
  - medium (デフォルト選択)
  - high
- [ ] ログディレクトリ: テキストボックス (デフォルト: "logs") + 参照ボタン
- [ ] AGENTS.mdファイル: テキストボックス + 参照ボタン

#### 参照ファイル/フォルダグループ
- [ ] GroupBox "参照ファイル/フォルダ" が表示されている
- [ ] ListBox が表示されている
- [ ] ボタン "ファイル追加" が表示されている
- [ ] ボタン "フォルダ追加" が表示されている
- [ ] ボタン "削除" が表示されている

#### ステータス表示エリア
- [ ] GroupBox "実行進捗・ステータス" が表示されている
- [ ] テキストボックスに "待機中" と表示されている
- [ ] テキストボックスが読み取り専用
- [ ] スクロールバーが機能する

#### ボタンエリア
- [ ] ボタン "読み込み" が表示されている
- [ ] ボタン "保存" が表示されている
- [ ] ボタン "実行" が表示されている（太字、アクセントカラー）

## 機能テスト

### 5. ファイル/フォルダ参照

#### 作業ディレクトリ参照
1. 「参照」ボタンをクリック
2. フォルダブラウザダイアログが表示される
3. フォルダを選択して OK
4. テキストボックスにパスが入力される

#### ログディレクトリ参照
（作業ディレクトリと同様）

#### AGENTS.mdファイル参照
1. 「参照」ボタンをクリック
2. ファイルオープンダイアログが表示される
3. フィルタ: "Markdown Files (*.md)|*.md|All Files (*.*)|*.*"
4. ファイルを選択して OK
5. テキストボックスにパスが入力される

### 6. 参照ファイル/フォルダ管理

#### ファイル追加
1. 「ファイル追加」ボタンをクリック
2. ファイルオープンダイアログが表示される（複数選択可能）
3. ファイルを選択して OK
4. ListBox に追加される

#### フォルダ追加
1. 「フォルダ追加」ボタンをクリック
2. フォルダブラウザダイアログが表示される
3. フォルダを選択して OK
4. ListBox に追加される

#### 削除
1. ListBox の項目を選択
2. 「削除」ボタンをクリック
3. 選択された項目が削除される

### 7. 設定の保存

1. プロンプトに "テストプロンプト" と入力
2. オプションを変更（例: モデルを変更）
3. 参照ファイルを追加
4. 「保存」ボタンをクリック
5. メッセージボックス "設定をprompt.jsonに保存しました。" が表示される
6. ステータスに "設定を保存しました。" と表示される

#### 検証
- [ ] prompt.json ファイルが作成される
- [ ] JSON フォーマットが正しい
- [ ] UTF-8 エンコーディング（BOM なし）
- [ ] 日本語が正しく保存される

```json
{
  "prompt": "テストプロンプト",
  "options": {
    "working_directory": ".",
    "model": "claude-sonnet-4-20250514",
    "auto_level": "medium",
    "log_directory": "logs"
  }
}
```

### 8. 設定の読み込み

1. prompt.json が存在する状態で起動
2. または「読み込み」ボタンをクリック

#### 期待される結果
- [ ] プロンプトテキストが読み込まれる
- [ ] 作業ディレクトリが読み込まれる
- [ ] モデルが正しく選択される
- [ ] 自動化レベルが正しく選択される
- [ ] ログディレクトリが読み込まれる
- [ ] AGENTS.mdファイルパスが読み込まれる（存在する場合）
- [ ] 参照ファイル/フォルダリストが読み込まれる（存在する場合）
- [ ] ステータスに "設定を読み込みました。" と表示される

### 9. バリデーション

#### プロンプト未入力
1. プロンプトを空にする
2. 「保存」または「実行」ボタンをクリック
3. メッセージボックス "プロンプトを入力してください。" が表示される

#### invoke-droid.ps1 が存在しない
1. invoke-droid.ps1 を削除またはリネーム
2. 「実行」ボタンをクリック
3. エラーメッセージが表示される

### 10. DROID実行テスト

#### 前提条件
- DROID がインストールされている
- PATH に droid コマンドが通っている
- prompt.json が正しく設定されている

#### 実行手順
1. プロンプトに有効な内容を入力
2. 「実行」ボタンをクリック

#### 期待される結果
- [ ] ステータスに "設定を保存しています..." と表示される
- [ ] ステータスに "DROIDを実行中..." と表示される
- [ ] 「実行」「保存」「読み込み」ボタンが無効化される
- [ ] PowerShell が起動する
- [ ] DROID の出力がリアルタイムでステータスに表示される
- [ ] 実行完了後、ボタンが有効化される
- [ ] 成功時: メッセージボックス "DROIDの実行が完了しました。"
- [ ] 失敗時: エラーメッセージが表示される

## ModernWpf デザインテスト

### 11. ライトテーマ

Windows 設定でライトテーマを選択

#### 期待される結果
- [ ] ウィンドウ背景が明るい色
- [ ] テキストが暗い色
- [ ] コントロールがライトテーマスタイル

### 12. ダークテーマ

Windows 設定でダークテーマを選択

#### 期待される結果
- [ ] ウィンドウ背景が暗い色
- [ ] テキストが明るい色
- [ ] コントロールがダークテーマスタイル

### 13. アクセントカラー

Windows 設定でアクセントカラーを変更

#### 期待される結果
- [ ] 「実行」ボタンの色が変更される
- [ ] フォーカス時のハイライトカラーが変更される

### 14. インタラクション

#### ホバー効果
- [ ] ボタンにマウスを重ねると背景色が変わる
- [ ] スムーズなアニメーション

#### フォーカス効果
- [ ] テキストボックスにフォーカスすると枠が強調される
- [ ] ComboBox にフォーカスすると枠が強調される

#### クリック効果
- [ ] ボタンクリック時にリップルアニメーション

## パフォーマンステスト

### 15. 起動時間

- [ ] 初回起動: 3秒以内
- [ ] 2回目以降: 2秒以内

### 16. レスポンシブ性

- [ ] UI操作が即座に反応する
- [ ] DROID実行中もUIがフリーズしない
- [ ] ウィンドウのリサイズがスムーズ

## 互換性テスト

### 17. Windows Forms版との設定互換性

1. Windows Forms版で設定を保存
2. WPF版で読み込み
3. すべての設定が正しく読み込まれる

1. WPF版で設定を保存
2. Windows Forms版で読み込み
3. すべての設定が正しく読み込まれる

## エラーハンドリングテスト

### 18. 異常系テスト

#### 不正なJSON
1. prompt.json を破損させる
2. アプリを起動
3. エラーメッセージが表示される
4. デフォルト設定で起動する

#### ディスク容量不足
1. ディスク容量が不足している状態
2. 設定を保存
3. エラーメッセージが表示される

#### 権限エラー
1. 読み取り専用ディレクトリで実行
2. 設定を保存
3. エラーメッセージが表示される

## セキュリティテスト

### 19. パス インジェクション

- [ ] ファイルパスに特殊文字を含む場合の動作
- [ ] 相対パスと絶対パスの処理
- [ ] ネットワークパス (UNC) の処理

## テスト結果記録

### テスト実施日: __________

### テスター: __________

### 環境:
- OS: Windows __ (バージョン: _______)
- .NET SDK: _______
- DROID バージョン: _______

### 結果サマリー:
- 総テスト項目数: ____
- 合格: ____
- 不合格: ____
- 未実施: ____

### 不具合リスト:
1. 
2. 
3. 

### 備考:
