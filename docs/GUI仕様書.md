# DROID Desktop GUI 仕様書

## 1. 概要

Factory.ai DROIDを簡単に使用できるPythonベースのデスクトップGUIアプリケーションの仕様書です。

## 2. 目的

- コマンドラインやJSONファイルの編集に不慣れなユーザーでもDROIDを簡単に使用できるようにする
- プロンプトとパラメータをGUI上で直感的に入力・編集できるようにする
- 既存のprompt.jsonとの互換性を保つ

## 3. 機能要件

### 3.1 起動方法
- `run-droid.bat` を実行すると、Python Desktop GUIが起動する
- GUIが起動すると同時に、既存の `prompt.json` があれば内容を読み込んで表示する

### 3.2 GUI画面構成

#### 3.2.1 メインウィンドウ
- **ウィンドウタイトル**: "DROID Desktop GUI"
- **サイズ**: 800x600 ピクセル（最小サイズ）
- **リサイズ可能**: はい

#### 3.2.2 入力項目

1. **プロンプト入力欄**
   - ラベル: "プロンプト (Prompt)"
   - 入力形式: テキストエリア（複数行）
   - サイズ: 幅いっぱい × 高さ 150px
   - 必須項目: はい
   - 説明: DROIDへの指示内容を入力

2. **作業ディレクトリ (Working Directory)**
   - ラベル: "作業ディレクトリ"
   - 入力形式: テキストボックス + フォルダ参照ボタン
   - デフォルト値: "."（カレントディレクトリ）
   - 説明: DROIDの実行ディレクトリ

3. **モデル選択 (Model)**
   - ラベル: "モデル"
   - 入力形式: ドロップダウンリスト
   - 選択肢:
     - claude-opus-4-5-20251101
     - claude-sonnet-4-20250514
     - claude-sonnet-4-5-20241022
     - claude-haiku-4-20250116
   - デフォルト値: claude-sonnet-4-20250514
   - 説明: 使用するAIモデル

4. **自動化レベル (Auto Level)**
   - ラベル: "自動化レベル"
   - 入力形式: ドロップダウンリスト
   - 選択肢: low, medium, high
   - デフォルト値: medium
   - 説明: ファイル変更の自動承認レベル

5. **ログディレクトリ (Log Directory)**
   - ラベル: "ログディレクトリ"
   - 入力形式: テキストボックス + フォルダ参照ボタン
   - デフォルト値: "logs"
   - 説明: ログファイルの保存先

6. **参照ファイル/フォルダ (Reference Paths)**
   - ラベル: "参照ファイル/フォルダ"
   - 入力形式: リストボックス + 追加/削除ボタン
   - 説明: DROIDに参照させるファイルやフォルダのパス
   - 機能:
     - 「追加」ボタン: ファイル/フォルダ選択ダイアログを表示
     - 「削除」ボタン: 選択中の項目を削除

#### 3.2.3 ボタン

1. **実行ボタン**
   - 位置: 右下
   - ラベル: "実行"
   - 機能: 
     - 入力内容を prompt.json に保存
     - DROIDコマンドを実行
     - 実行中は進行状況を表示
   - 無効化条件: プロンプトが空の場合

2. **保存ボタン**
   - 位置: 右下（実行ボタンの左）
   - ラベル: "保存"
   - 機能: 入力内容を prompt.json に保存（実行はしない）

3. **読み込みボタン**
   - 位置: 右下（保存ボタンの左）
   - ラベル: "読み込み"
   - 機能: prompt.json から設定を再読み込み

#### 3.2.4 ステータス表示エリア
- 位置: 画面下部（ボタンの上）
- 機能: 
  - 実行状態の表示（待機中、実行中、完了、エラー）
  - ログファイルの保存先表示
  - エラーメッセージの表示

## 4. 技術仕様

### 4.1 使用技術
- **言語**: Python 3.8以上
- **GUIフレームワーク**: tkinter（標準ライブラリ）
- **その他のライブラリ**: 
  - json（標準ライブラリ）
  - subprocess（標準ライブラリ）
  - pathlib（標準ライブラリ）

### 4.2 ファイル構成
```
DROID/
├── run-droid.bat          # GUIを起動するバッチファイル（更新）
├── gui_droid.py           # GUIアプリケーション本体（新規作成）
├── invoke-droid.ps1       # PowerShellスクリプト（既存）
├── prompt.json            # 設定ファイル（既存）
└── docs/
    └── GUI仕様書.md      # 本仕様書（新規作成）
```

### 4.3 データフォーマット（prompt.json）
```json
{
    "prompt": "プロンプト内容",
    "options": {
        "working_directory": "作業ディレクトリパス",
        "model": "モデル名",
        "auto_level": "自動化レベル",
        "log_directory": "ログディレクトリパス",
        "ref_filepath": [
            "参照ファイルパス1",
            "参照ファイルパス2"
        ]
    }
}
```

### 4.4 実行フロー

1. **起動時**
   - GUIウィンドウを表示
   - prompt.json が存在する場合、内容を読み込んで各フィールドに設定
   - 存在しない場合、デフォルト値を設定

2. **保存時**
   - 入力内容をバリデーション
   - prompt.json にUTF-8形式で保存
   - ステータスエリアに成功メッセージを表示

3. **実行時**
   - 入力内容をバリデーション
   - prompt.json に保存
   - PowerShellスクリプト（invoke-droid.ps1）を呼び出し
   - 実行中はボタンを無効化
   - ステータスエリアに進行状況を表示
   - 完了後、ログファイルのパスを表示

## 5. UI/UXガイドライン

### 5.1 配色
- 背景色: システムデフォルト
- アクセントカラー: ブルー系（実行ボタンなど）
- エラー表示: レッド系

### 5.2 フォント
- 日本語対応フォント（システムデフォルト）
- サイズ: 10pt（標準）

### 5.3 レイアウト
- パディング: 各要素間に適切な余白を設定
- グループ化: 関連する項目をLabelFrameでグループ化
- 配置: 上から下への自然な入力フロー

## 6. エラーハンドリング

### 6.1 入力バリデーション
- プロンプトが空の場合: エラーメッセージを表示し、実行ボタンを無効化
- ディレクトリパスが存在しない場合: 警告を表示

### 6.2 実行時エラー
- DROIDコマンドが見つからない: エラーメッセージを表示
- PowerShellスクリプトの実行失敗: エラーメッセージとログファイルパスを表示
- JSONファイルの読み書きエラー: エラーメッセージを表示

## 7. 今後の拡張可能性

- 実行履歴の保存と再利用
- テンプレート機能（よく使うプロンプトの保存）
- 実行結果のプレビュー表示
- ダークモード対応
- 多言語対応（英語など）

## 8. 制約事項

- Windows環境のみサポート（バッチファイルとPowerShellを使用）
- DROIDがインストールされている必要がある
- Python 3.8以上が必要

## 9. 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|---------|
| 2026-01-17 | 1.0 | 初版作成 |
