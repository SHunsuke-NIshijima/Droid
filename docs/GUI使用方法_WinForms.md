# DROID Desktop GUI (Windows Forms版) 使用方法

## 概要

DROID Desktop GUIは、Windows標準のPowerShell Windows Formsを使用したデスクトップアプリケーションです。Pythonのインストールは不要で、Windows標準搭載のコンポーネントのみを使用します。

## 起動方法

1. `run-droid.bat` をダブルクリックまたは実行します
2. Windows Forms GUIが起動します

## 画面の使い方

### 1. プロンプト入力
- **必須項目**です
- DROIDに実行させたい指示を入力します
- 複数行入力可能です

例：
```
このプロジェクトのコードをレビューして改善点を教えて
```

### 2. オプション設定

#### 作業ディレクトリ
- DROIDを実行するディレクトリを指定します
- デフォルト: `.`（カレントディレクトリ）
- 「参照」ボタンでフォルダを選択できます

#### モデル
- 使用するAIモデルを選択します
- 選択肢:
  - `claude-opus-4-5-20251101` - 最高性能（高コスト）
  - `claude-sonnet-4-20250514` - バランス型（推奨）
  - `claude-sonnet-4-5-20241022` - バランス型
  - `claude-haiku-4-20250116` - 高速（低コスト）

#### 自動化レベル
- ファイル変更の自動承認レベルを設定します
- 選択肢:
  - `low` - 手動で確認
  - `medium` - 一部自動承認（推奨）
  - `high` - 全て自動承認

#### ログディレクトリ
- ログファイルの保存先を指定します
- デフォルト: `logs`
- 「参照」ボタンでフォルダを選択できます

#### AGENTS.mdファイル（新機能）
- DROIDのエージェント設定ファイルを指定します
- オプション項目（指定しなくても実行可能）
- 「参照」ボタンでファイルを選択できます

### 3. 参照ファイル/フォルダ
- DROIDに参照させたいファイルやフォルダを追加します
- **ファイル追加**: 参照ファイルを選択して追加（複数選択可能）
- **フォルダ追加**: 参照フォルダを選択して追加
- **削除**: 選択中の項目を削除

### 4. ボタン操作

#### 読み込み
- `prompt.json` から設定を再読み込みします
- 起動時に自動で読み込まれます

#### 保存
- 現在の入力内容を `prompt.json` に保存します
- 実行せずに保存だけ行いたい場合に使用します

#### 実行
- 入力内容を保存してDROIDを実行します
- 実行中はボタンが無効化されます
- ステータスエリアに進行状況が表示されます

### 5. ステータス表示
- 現在の状態（待機中、実行中、完了、エラー）が表示されます

## 前提条件

### 必須
- Windows PowerShell（Windows標準搭載）
- Factory.ai DROID（`droid`コマンドがPATHに通っていること）

### PowerShellの確認
```cmd
powershell -version
```

PowerShell 5.0以上が表示されればOKです。

### DROIDのインストール確認
```cmd
droid --version
```

DROIDのバージョンが表示されればOKです。

## トラブルシューティング

### GUIが起動しない
→ コマンドプロンプトから以下を実行してエラーメッセージを確認してください
```cmd
cd /d "C:\path\to\Droid"
powershell -NoProfile -ExecutionPolicy Bypass -File gui_droid_winforms.ps1
```

### 「スクリプトの実行が無効」エラー
→ PowerShellの実行ポリシーを確認してください
```cmd
powershell -ExecutionPolicy Bypass -File gui_droid_winforms.ps1
```

### 「droidコマンドが見つからない」エラー
→ DROIDが正しくインストールされているか確認してください
→ `droid`コマンドがPATHに通っているか確認してください

### 文字化けする場合
→ `prompt.json` をUTF-8で保存してください

### 実行が完了しない
→ ログファイル（`logs`フォルダ内）を確認してください
→ DROIDの実行には時間がかかる場合があります

## ファイル構成

```
DROID/
├── run-droid.bat              # GUIを起動するバッチファイル
├── gui_droid_winforms.ps1     # Windows Forms GUIアプリケーション
├── invoke-droid.ps1           # PowerShellスクリプト
├── prompt.json                # 設定ファイル（自動生成）
├── logs/                      # ログディレクトリ（自動生成）
└── docs/
    ├── GUI使用方法_WinForms.md  # このファイル
    └── GUI仕様書.md             # 仕様書
```

## 注意事項

- 実行中は他の操作を行わないでください
- 大きなプロジェクトの場合、実行に時間がかかることがあります
- ログファイルは自動的に作成・保存されます（削除しても問題ありません）
- `prompt.json` を直接編集することも可能です

## AGENTS.mdファイルについて

AGENTS.mdファイルは、DROIDのカスタムエージェント設定を定義するファイルです。

### 使い方
1. AGENTS.mdファイルを作成
2. GUIの「AGENTS.mdファイル」欄でファイルを選択
3. 実行ボタンをクリック

### 設定例
AGENTS.mdファイルが指定されている場合、prompt.jsonに以下のように保存されます：

```json
{
  "prompt": "コードをレビューして",
  "options": {
    "working_directory": ".",
    "model": "claude-sonnet-4-20250514",
    "auto_level": "medium",
    "log_directory": "logs",
    "agents_file": "C:/path/to/AGENTS.md"
  }
}
```

## よくある使い方

### ケース1: ファイル操作
1. プロンプト: `このフォルダ内のファイル一覧を表示して`
2. 作業ディレクトリ: `.`
3. 実行ボタンをクリック

### ケース2: コード作成
1. プロンプト: `Pythonで簡単な電卓アプリを作成して`
2. 作業ディレクトリ: 作成先のフォルダを指定
3. 実行ボタンをクリック

### ケース3: コードレビュー
1. プロンプト: `このコードをレビューして改善点を教えて`
2. 参照ファイル/フォルダ: レビュー対象のファイルを追加
3. 実行ボタンをクリック

### ケース4: カスタムエージェント使用
1. プロンプト: `カスタムエージェントを使用してタスクを実行`
2. AGENTS.mdファイル: エージェント設定ファイルを指定
3. 実行ボタンをクリック

## サポート

問題が発生した場合は、ログファイル（`logs`フォルダ内）を確認してください。
ログには実行の詳細が記録されています。

## Python版GUIとの違い

### Windows Forms版（新版）
- ✅ Windows標準搭載（追加インストール不要）
- ✅ AGENTS.mdファイル指定機能
- ✅ ネイティブなWindows UI

### Python版（レガシー）
- Python 3.8以上が必要
- Tkinterを使用
- AGENTS.mdファイル指定機能なし

新規ユーザーには**Windows Forms版**をお勧めします。
