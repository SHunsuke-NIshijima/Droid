# DROID Desktop GUI - Windows Forms版 画面イメージ

## GUIの構成

```
┌─────────────────────────────────────────────────────────────────────┐
│  DROID Desktop GUI                                          [_][□][X]│
├─────────────────────────────────────────────────────────────────────┤
│                                                                       │
│  プロンプト (Prompt) *                                                │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │                                                               │  │
│  │  columns_output.xlsxに追加列としてinput_data.xlsxの各列の   │  │
│  │  ユニーク値の数を追加してください。                           │  │
│  │                                                               │  │
│  │                                                               │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                       │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │ オプション設定                                                 │  │
│  ├───────────────────────────────────────────────────────────────┤  │
│  │                                                               │  │
│  │  作業ディレクトリ:    [.                          ] [参照]    │  │
│  │                                                               │  │
│  │  モデル:              [claude-sonnet-4-20250514  ▼]          │  │
│  │                                                               │  │
│  │  自動化レベル:        [medium                    ▼]          │  │
│  │                                                               │  │
│  │  ログディレクトリ:    [logs                       ] [参照]    │  │
│  │                                                               │  │
│  │  AGENTS.mdファイル:   [                           ] [参照]    │  │
│  │                      ⬆ 新機能：エージェント設定ファイル       │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                       │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │ 参照ファイル/フォルダ                                          │  │
│  ├───────────────────────────────────────────────────────────────┤  │
│  │ ┌─────────────────────────────────────────┐  ┌────────────┐ │  │
│  │ │ .\sample\input_data.xlsx                │  │ファイル追加│ │  │
│  │ │ .\sample\columns_output.xlsx            │  ├────────────┤ │  │
│  │ │                                         │  │フォルダ追加│ │  │
│  │ │                                         │  ├────────────┤ │  │
│  │ │                                         │  │   削除     │ │  │
│  │ │                                         │  └────────────┘ │  │
│  │ └─────────────────────────────────────────┘                  │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                       │
│  ┌───────────────────────────────────────────────────────────────┐  │
│  │ ステータス                                                     │  │
│  ├───────────────────────────────────────────────────────────────┤  │
│  │ 待機中                                                        │  │
│  │                                                               │  │
│  └───────────────────────────────────────────────────────────────┘  │
│                                                                       │
│                            [ 読み込み ] [ 保存 ] [ 実行 ]            │
│                                                                       │
└─────────────────────────────────────────────────────────────────────┘
```

## 主な変更点

### 🆕 新機能: AGENTS.mdファイル指定

**オプション設定**セクションに新しいフィールドが追加されました：

```
AGENTS.mdファイル:   [                           ] [参照]
```

- DROIDのカスタムエージェント設定ファイルを指定できます
- オプション項目（指定しなくても実行可能）
- 「参照」ボタンでMarkdownファイルを選択
- 選択したパスがprompt.jsonに保存されます

### 技術的変更

#### 従来版（Tkinter）
```python
import tkinter as tk
from tkinter import ttk, scrolledtext, filedialog, messagebox
```
- Pythonインストールが必要
- クロスプラットフォーム

#### 新版（Windows Forms）
```powershell
Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing
```
- Windows標準搭載
- Pythonインストール不要
- ネイティブなWindows UI

## 使用例

### AGENTS.mdファイルを使用する場合

1. **AGENTS.mdファイルを準備**
   ```markdown
   # カスタムエージェント設定
   
   エージェントの動作を定義...
   ```

2. **GUIで設定**
   - プロンプト: `カスタムエージェントでコードをレビュー`
   - AGENTS.mdファイル: `[参照]` ボタンでファイル選択
   - 実行ボタンをクリック

3. **prompt.jsonに保存される内容**
   ```json
   {
     "prompt": "カスタムエージェントでコードをレビュー",
     "options": {
       "working_directory": ".",
       "model": "claude-sonnet-4-20250514",
       "auto_level": "medium",
       "log_directory": "logs",
       "agents_file": "C:/path/to/AGENTS.md"
     }
   }
   ```

## 画面の特徴

### Windows Forms特有の機能

1. **ネイティブダイアログ**
   - Windows標準のフォルダ/ファイル選択ダイアログ
   - 使い慣れたWindows UIで操作可能

2. **ドロップダウンリスト**
   - モデル選択：4種類から選択
   - 自動化レベル：low/medium/high から選択

3. **マルチライン入力**
   - プロンプト入力エリア：スクロール対応
   - ステータス表示エリア：実行状態をリアルタイム表示

4. **リストボックス**
   - 参照ファイル/フォルダの管理
   - 複数アイテムの追加/削除が可能

## 動作フロー

### 起動時
```
run-droid.bat 実行
    ↓
PowerShell起動
    ↓
Windows Forms GUI表示
    ↓
prompt.json自動読み込み
    ↓
待機状態
```

### 実行時
```
[実行]ボタンクリック
    ↓
入力検証
    ↓
prompt.json保存
    ↓
PowerShellスクリプト実行
    ↓
ステータス更新
    ↓
完了/エラー表示
```

## システム要件

### 必須
- Windows 7以降
- PowerShell 5.0以降（Windows標準）
- Factory.ai DROID

### オプション
- Python不要 ✅
- 追加ライブラリ不要 ✅

## Python版との比較

| 項目 | Windows Forms版 | Python版（レガシー） |
|------|----------------|-------------------|
| インストール | 不要（標準搭載） | Python 3.8+必要 |
| UI | Windows Forms | Tkinter |
| AGENTS.md | ✅ 対応 | ❌ 非対応 |
| プラットフォーム | Windows専用 | クロスプラットフォーム |
| 起動速度 | 速い | やや遅い |
| 見た目 | ネイティブ | 汎用的 |

## まとめ

Windows Forms版は：
- ✅ Windows標準搭載で追加インストール不要
- ✅ AGENTS.mdファイル指定機能を追加
- ✅ ネイティブなWindows UIで使いやすい
- ✅ 既存のprompt.json形式と完全互換
- ✅ 高速起動

**Windows環境での使用を強く推奨します。**
